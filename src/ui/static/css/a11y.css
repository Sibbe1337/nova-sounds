/* 
 * Accessibility CSS
 * Enhancements for better accessibility
 */

/* Focus outline handling */
:focus {
    outline: 3px solid var(--primary-color);
    outline-offset: 2px;
}

/* Remove outline for mouse users but keep for keyboard */
:focus:not(:focus-visible) {
    outline: none;
}

:focus-visible {
    outline: 3px solid var(--primary-color);
    outline-offset: 2px;
}

/* Skip link for keyboard users */
.skip-to-content {
    position: absolute;
    top: -40px;
    left: 0;
    padding: 8px 15px;
    background-color: var(--primary-color);
    color: white;
    z-index: 9999;
    transition: top 0.3s;
}

.skip-to-content:focus {
    top: 0;
}

/* High contrast mode enhancements */
@media (forced-colors: active) {
    /* Add borders to buttons in high contrast mode */
    .btn {
        border: 1px solid transparent;
    }
    
    /* Ensure text remains readable */
    .text-gradient,
    .gradient-text {
        background: none !important;
        color: CanvasText !important;
        -webkit-text-fill-color: CanvasText !important;
    }
    
    /* Make card boundaries clear */
    .card {
        border: 1px solid CanvasText;
    }
}

/* Keyboard navigation enhancement */
[role="button"],
button,
a,
select,
input,
textarea {
    transition: outline-offset 0.1s linear;
}

[role="button"]:focus-visible,
button:focus-visible,
a:focus-visible,
select:focus-visible,
input:focus-visible,
textarea:focus-visible {
    outline-offset: 4px;
}

/* Screen reader only class */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
}

/* Ensure proper contrast on light/dark themes */
:root {
    --a11y-focus-color: #2563EB;
    --a11y-error-color: #DC2626;
    --a11y-success-color: #059669;
}

.dark-theme {
    --a11y-focus-color: #3B82F6;
    --a11y-error-color: #EF4444;
    --a11y-success-color: #10B981;
}

/* Enhanced form elements for accessibility */
.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
}

/* Form validation messages for screen readers */
.error-message[aria-live="polite"] {
    color: var(--error-color);
}

/* Keyboard focus indicator for interactive elements */
.kb-focus-within {
    box-shadow: 0 0 0 3px var(--a11y-focus-color);
    outline: none;
}

/* Utility classes for accessible text */
.text-larger {
    font-size: 1.2em;
}

.line-height-increased {
    line-height: 1.7;
}

.letter-spacing-increased {
    letter-spacing: 0.03em;
}

/* Enhanced cursor for interactive elements */
[role="button"],
[tabindex]:not([tabindex="-1"]) {
    cursor: pointer;
}

/* ARIA expanded attributes */
[aria-expanded="true"] .icon-expand::before {
    content: "\f077"; /* Font Awesome chevron up */
}

[aria-expanded="false"] .icon-expand::before {
    content: "\f078"; /* Font Awesome chevron down */
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
    * {
        transition-duration: 0.001s !important;
        animation-duration: 0.001s !important;
    }
    
    .animation,
    .transition,
    .animated,
    [class*="animate-"],
    [class*="fade-"],
    [class*="slide-"] {
        animation: none !important;
        transition: none !important;
    }
    
    .no-animation-when-reduced-motion {
        animation: none !important;
        transition: none !important;
    }
}

/* Enhancing color contrast */
.enhanced-contrast {
    --primary-color: var(--a11y-focus-color);
    --text-color: #000000;
    --text-color-light: #444444;
    --border-color: #000000;
    --background-color: #FFFFFF;
}

.dark-theme.enhanced-contrast {
    --primary-color: var(--a11y-focus-color);
    --text-color: #FFFFFF;
    --text-color-light: #DDDDDD;
    --border-color: #FFFFFF;
    --background-color: #121212;
}

/* Better visibility for notification elements */
.notification {
    border: 1px solid currentColor;
}

.notification.error {
    border-color: var(--a11y-error-color);
}

.notification.success {
    border-color: var(--a11y-success-color);
}

/* Ensure readability of placeholder text */
::placeholder {
    color: #767676; /* WCAG AA compliant */
    opacity: 1;
}

/* Skip navigation link - becomes visible on focus */
.skip-link {
    position: absolute;
    top: -40px;
    left: 0;
    background: var(--primary-color);
    color: white;
    padding: 8px 16px;
    z-index: var(--z-index-fixed);
    transition: top 0.2s ease;
}

.skip-link:focus {
    top: 0;
    outline: none;
    box-shadow: 0 0 0 3px rgba(var(--primary-color-rgb), 0.5);
}

/* Focus styles */
:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
}

/* Provide a visible focus indicator that meets WCAG contrast requirements */
a:focus,
button:focus,
input:focus,
select:focus,
textarea:focus {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(var(--primary-color-rgb), 0.25);
}

/* Don't show focus styles on click, only on keyboard navigation */
.js-focus-visible :focus:not(.focus-visible) {
    outline: none;
    box-shadow: none;
}

.js-focus-visible .focus-visible {
    outline: 2px solid var(--primary-color);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(var(--primary-color-rgb), 0.25);
}

/* High contrast mode enhancements */
@media (prefers-contrast: more) {
    :root {
        --primary-color: #0050ff;
        --error-color: #ff0000;
        --success-color: #00a000;
        --warning-color: #ff8000;
        --info-color: #0088ff;
    }
    
    body {
        color: black;
        background-color: white;
    }
    
    a {
        color: #0000EE;
        text-decoration: underline;
    }
    
    a:visited {
        color: #551A8B;
    }
    
    :focus {
        outline: 3px solid black;
        outline-offset: 2px;
    }
}

/* Reduced motion settings */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.001s !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001s !important;
        scroll-behavior: auto !important;
    }
    
    .loading-spinner,
    .progress-fill,
    .skeleton::after {
        animation: none !important;
    }
}

/* Improve text legibility */
body {
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Enhanced keyboard navigation */
[role="button"],
button,
input,
select,
textarea,
a {
    cursor: pointer;
}

[tabindex]:not([tabindex="-1"]) {
    cursor: pointer;
}

/* Improved form accessibility */
label {
    display: block;
    margin-bottom: 8px;
    font-weight: var(--font-weight-medium);
}

.form-group {
    margin-bottom: 24px;
}

/* Add a visual asterisk to required form fields */
.required::after {
    content: '*';
    color: var(--error-color);
    margin-left: 4px;
}

/* Accessible error messages for forms */
.form-error {
    color: var(--error-color);
    font-size: var(--font-size-sm);
    margin-top: 4px;
    display: flex;
    align-items: center;
}

.form-error::before {
    content: '⚠️';
    margin-right: 6px;
}

/* Make form elements easier to interact with */
input[type="checkbox"],
input[type="radio"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

/* Focus management for modals and dialogs */
.modal {
    /* Ensure the modal is properly placed in the focus order */
    position: fixed;
    z-index: var(--z-index-modal);
}

[role="dialog"] {
    outline: none;
}

/* Provide support for aria-expanded */
[aria-expanded="true"] .collapse-icon {
    transform: rotate(180deg);
}

[aria-expanded="false"] + [aria-hidden="true"] {
    display: none;
}

/* Support for aria-current */
[aria-current="page"] {
    font-weight: var(--font-weight-bold);
    position: relative;
}

[aria-current="page"]::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    right: 0;
    height: 3px;
    background-color: var(--primary-color);
    border-radius: 3px;
}

/* Support for aria-busy */
[aria-busy="true"] {
    position: relative;
    pointer-events: none;
}

[aria-busy="true"]::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255, 255, 255, 0.5);
    z-index: 1;
}

.dark-theme [aria-busy="true"]::after {
    background-color: rgba(0, 0, 0, 0.5);
}

/* Support for RTL languages */
[dir="rtl"] {
    text-align: right;
}

[dir="rtl"] .ml-auto {
    margin-left: 0;
    margin-right: auto;
}

[dir="rtl"] .mr-auto {
    margin-right: 0;
    margin-left: auto;
}

/* Support for prefers-color-scheme */
@media (prefers-color-scheme: dark) {
    :root:not(.light-theme) {
        --background-color: #1c1c1e;
        --card-bg: #2c2c2e;
        --text-color: #f5f5f7;
        --text-color-light: #98989d;
        --border-color: #3a3a3c;
    }
}

/* Live announcer for screen readers */
.live-announcer {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
}

/* When content is focusable but not interactive */
[tabindex="0"] {
    cursor: default;
}

/* ARIA roles styled appropriately */
[role="alert"],
[role="alertdialog"] {
    border: 2px solid var(--error-color);
    padding: 16px;
    border-radius: var(--radius-md);
    margin: 16px 0;
}

[role="complementary"] {
    padding: 16px;
    border-left: 3px solid var(--border-color);
    margin: 16px 0;
}

[role="tooltip"] {
    background-color: var(--text-color);
    color: var(--background-color);
    padding: 8px 12px;
    border-radius: var(--radius-sm);
    font-size: var(--font-size-sm);
    box-shadow: var(--shadow-md);
    z-index: var(--z-index-tooltip);
}

/* Custom focus indicator for non-text contrast mode */
.focus-outline {
    position: relative;
}

.focus-outline:focus-visible::before {
    content: '';
    position: absolute;
    top: -4px;
    left: -4px;
    right: -4px;
    bottom: -4px;
    border: 2px solid var(--primary-color);
    border-radius: var(--radius-md);
    pointer-events: none;
} 